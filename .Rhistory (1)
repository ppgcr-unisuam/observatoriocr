for(i in 1:length(alluv.data.aggr$LP)) {
alluv.colors <- c(alluv.colors,
brewer.pal(n = length(linhas), name = "Set3")[alluv.data.aggr$LP[i]])
}
# plot area setup
par(
oma = c(1, 1, 1, 1),
mar = c(1, 1, 1, 1),
bg = '#2C3E50',
col.lab = "white",
col.axis = NA,
fg = NA
)
# plot 1
alluvial(
alluv.data.aggr[, 1:3],
freq = alluv.data.aggr$Freq,
col = alluv.colors,
border = NA,
blocks = FALSE
)
alluv.data.aggr[, 1:3]
start
length(start)
dim(alluv.data.aggr)
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
source("Scripts/read_sucupira.R")
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
colnames(alluv.data.aggr) <- c("AC", "LP", "PP", "Freq")
alluv.data.aggr
head(alluv.data.aggr)
# reorder data
alluv.data.aggr <- alluv.data.aggr[order(start, decreasing = TRUE), ]
# reorder data
# get all history of 'linha de pesquisa'
linhas <- na.exclude(unique(alluv.data$sucupira.raw..Linha.de.Pesquisa.))
# recoding
alluv.data.aggr$AC <- as.numeric(as.factor(alluv.data.aggr$AC))
alluv.data.aggr$LP <- as.numeric(as.factor(alluv.data.aggr$LP))
alluv.data.aggr$PP <- as.numeric(as.factor(alluv.data.aggr$PP))
# colors
alluv.colors <- c()
View(alluv.data.aggr)
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
source("Scripts/read_sucupira.R")
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
colnames(alluv.data.aggr) <- c("AC", "LP", "PP", "Freq")
View(alluv.data)
order(start, decreasing = TRUE)
dim(alluv.data.aggr)
length(start)
options(knitr.kable.NA = '--', knitr.table.format = "html")
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
source("Scripts/read_sucupira.R")
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
colnames(alluv.data.aggr) <- c("AC", "LP", "PP", "Freq")
# get all history of 'linha de pesquisa'
linhas <- na.exclude(unique(alluv.data$sucupira.raw..Linha.de.Pesquisa.))
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
sucupira.raw..Nome.do.Projeto.de.Pesquisa)
ordering <- c(ordering, start[index])
}
length(alluv.data.aggr$PP)
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
# recoding
alluv.data.aggr$AC <- as.numeric(as.factor(alluv.data.aggr$AC))
alluv.data.aggr$LP <- as.numeric(as.factor(alluv.data.aggr$LP))
alluv.data.aggr$PP <- as.numeric(as.factor(alluv.data.aggr$PP))
# colors
alluv.colors <- c()
for(i in 1:length(alluv.data.aggr$LP)) {
alluv.colors <- c(alluv.colors,
brewer.pal(n = length(linhas), name = "Set3")[alluv.data.aggr$LP[i]])
}
# plot 1
alluvial(
alluv.data.aggr[, 1:3],
freq = alluv.data.aggr$Freq,
col = alluv.colors,
border = NA,
blocks = FALSE,
ordering = list(
order(ordering, decreasing = TRUE),
order(ordering, decreasing = TRUE),
order(ordering, decreasing = TRUE)
)
)
ordering
ordering <-
as.Date(as.POSIXct(as.numeric(ordering), origin = "1970-01-01"))
ordering
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering
options(knitr.kable.NA = '--', knitr.table.format = "html")
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
colnames(alluv.data.aggr) <- c("AC", "LP", "PP", "Freq")
# get all history of 'linha de pesquisa'
linhas <- na.exclude(unique(alluv.data$sucupira.raw..Linha.de.Pesquisa.))
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering <-
as.Date(as.POSIXct(as.numeric(ordering), origin = "1970-01-01"))
# recoding
alluv.data.aggr$AC <- as.numeric(as.factor(alluv.data.aggr$AC))
alluv.data.aggr$LP <- as.numeric(as.factor(alluv.data.aggr$LP))
alluv.data.aggr$PP <- as.numeric(as.factor(alluv.data.aggr$PP))
# colors
alluv.colors <- c()
for(i in 1:length(alluv.data.aggr$LP)) {
alluv.colors <- c(alluv.colors,
brewer.pal(n = length(linhas), name = "Set3")[alluv.data.aggr$LP[i]])
}
# plot area setup
par(
oma = c(1, 1, 1, 1),
mar = c(1, 1, 1, 1),
bg = '#2C3E50',
col.lab = "white",
col.axis = NA,
fg = NA
)
# plot 1
alluvial(
alluv.data.aggr[, 1:3],
freq = alluv.data.aggr$Freq,
col = alluv.colors,
border = NA,
blocks = FALSE,
ordering = list(
order(ordering, decreasing = TRUE),
order(ordering, decreasing = TRUE),
order(ordering, decreasing = TRUE)
)
)
title(main = "Área de Concentração - Linhas de Pesquisa - Projetos de Pesquisa",
outer = TRUE,
col.main = "white",
cex.main = 1.15)
# ordering
ordering <- c()
options(knitr.kable.NA = '--', knitr.table.format = "html")
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
source("Scripts/read_sucupira.R")
alluv.data <-
data.frame(
sucupira.raw$`Área de Concentração`,
sucupira.raw$`Linha de Pesquisa`,
sucupira.raw$`Nome do Projeto de Pesquisa`
)
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
# get all history of 'linha de pesquisa'
linhas <- na.exclude(unique(alluv.data$sucupira.raw..Linha.de.Pesquisa.))
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering <- c(ordering, start[index])
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering
# structure the alluvial plot
# projetos
sheet <- "Projetos"
source("Scripts/read_sucupira.R")
start <- sucupira.raw$`Data de Início`[complete.cases(alluv.data)]
alluv.data <- alluv.data[complete.cases(alluv.data),]
alluv.data.aggr <-
aggregate(
alluv.data,
by = list(
alluv.data$sucupira.raw..Área.de.Concentração.,
alluv.data$sucupira.raw..Linha.de.Pesquisa.,
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.
),
FUN = length
)
# drop repeated columns
alluv.data.aggr <- alluv.data.aggr[, 1:4]
colnames(alluv.data.aggr) <- c("AC", "LP", "PP", "Freq")
# get all history of 'linha de pesquisa'
linhas <- na.exclude(unique(alluv.data$sucupira.raw..Linha.de.Pesquisa.))
# ordering
ordering <- c()
for(i in 1:length(alluv.data.aggr$PP)){
index <- match(alluv.data.aggr$PP[i],
alluv.data$sucupira.raw..Nome.do.Projeto.de.Pesquisa.)
ordering <- c(ordering, start[index])
}
ordering
as.numeric(ordering)
as.Date(as.POSIXct(ordering, origin = "1970-01-01"))
as.Date(as.POSIXct(ordering)
as.Date(as.POSIXct(ordering), origin = "01-01-1970"))
as.Date(as.POSIXct(as.numeric(ordering), origin = "1970-01-01"))
ordering)
ordering
as.Date(ordering,
format = "%m/%d/%y")
as.Date(ordering,
format = "%m/%d/%y")
order(as.Date(ordering,
format = "%m/%d/%y"))
as.Date(ordering, format = "%y")
order(ordering, decreasing = TRUE)
# create a new code chunk and then use the PACKUP add-in to generate this code with all the required libraries for this Rmd
library(alluvial)
library(bsplus)
library(cowplot)
library(dplyr)
library(geobr)
library(ggplot2)
library(ggpubr)
library(grid)
library(gridExtra)
library(gtsummary)
library(htmlwidgets)
library(igraph)
library(kableExtra)
library(knitr)
library(magrittr)
library(RColorBrewer)
library(readxl)
library(Rmisc)
library(sf)
library(tm)
library(viridis)
library(webshot2)
library(wordcloud2)
# read SCImago csv file (download from https://www.scimagojr.com)
scimago <-
read.csv(
"SJR/scimagojr 2020.csv",
header = TRUE,
sep = ";",
quote = "\"",
dec = ",",
fill = TRUE
)
# read QUALIS xlsx file (download from https://www.scimagojr.com)
qualis <-
data.frame(read_excel(
"Qualis/QUALIS Referência 2017-2018.xlsx",
sheet = 1,
col_types = c("text")
))
# read data
artigos <-
data.frame(read_excel(
"../PPGCR Unisuam/Produção.xlsx",
sheet = "PI.artigos",
col_types = c("text")
))
# Data cleaning
artigos <- artigos[complete.cases(artigos$DOI),]
artigos$WebQualis[artigos$WebQualis == "Sem WebQualis"] <- "NA"
# remove os aceitos e submetidos
artigos <-
artigos[artigos$Publicado.em != "Aceito" &
artigos$Publicado.em != "Submetido", ]
# estratos Qualis
estratos <- sort(unique(artigos$WebQualis))
# SJR
SJR <- c()
for (i in 1:dim(artigos)[1]) {
SJR.i <-
as.numeric(scimago[grep(gsub("-", "", artigos$ISSN[i]), scimago$Issn), 6])
SJR <-
c(SJR, ifelse(identical(SJR.i, numeric(0)) |
all(is.na(SJR.i)), NA, SJR.i))
}
# generate cross tables of artigos per year
table.1 <- table(artigos$Publicado.em)
table.2 <- t(table(artigos$Publicado.em, artigos$WebQualis))
table.2 <- apply(table.2, 2, rev)
table.2 <- table.2[order(rownames(table.2)),]
table.3 <- data.frame(artigos$Publicado.em, SJR)
table.3.mean <-
aggregate(
table.3,
by = list(artigos$Publicado.em),
FUN = mean,
na.rm = TRUE
)
table.3.mean <- t(as.matrix(table.3.mean[, -2]))
table.3.mean <- as.numeric(table.3.mean[-1,])
names(table.3.mean) <- names(table.1)
table.3.min <-
aggregate(
table.3,
by = list(artigos$Publicado.em),
FUN = min,
na.rm = TRUE
)[, 3]
table.3.max <-
aggregate(
table.3,
by = list(artigos$Publicado.em),
FUN = max,
na.rm = TRUE
)[, 3]
names(table.3.min) <- names(table.3.mean)
names(table.3.max) <- names(table.3.mean)
# calculate summary statistics for producao
summ.table.producao <-
cbind(
sum(table.3),
formatC(
mean(table.3, na.rm = TRUE),
format = "d",
digits = 0,
big.mark = "."
),
formatC(
min(table.3, na.rm = TRUE),
format = "d",
digits = 0,
big.mark = "."
),
formatC(
max(table.3, na.rm = TRUE),
format = "d",
digits = 0,
big.mark = "."
),
formatC(
min(SJR, na.rm = TRUE),
format = "d",
digits = 0,
big.mark = "."
),
formatC(
max(SJR, na.rm = TRUE),
format = "d",
digits = 0,
big.mark = "."
)
)
table.3
table.2
table.1
table.2
table.2[1,]
table.2[1:4,]
