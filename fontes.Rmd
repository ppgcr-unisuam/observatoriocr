---
title: Fontes dos dados

output:
  html_document:
    toc: true
---

<!--install and/or load all R packages-->
```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE}
source("Scripts/all-required-packages.R")
```

<!--script for computer/mobile devices-->
```{css, echo=FALSE}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    body .main-container {
      max-width: 1280px !important;
      width: 80%;
      margin: auto;
      }
    body {
      max-width: 1280px !important;
      width: 80%;
      margin: auto;
    }
      section {
      position: absolute;
      top: 50%;
      left: 50%;
      margin-right: -50%;
      transform: translate(-50%, -50%)
    }
```

<!--script for narrow margins-->
<style type="text/css">
div.main-container {
  max-width: 1800px;
  margin-left: auto;
  margin-right: auto;
}
</style>

<!--script for inserting LOGO ABOVE THE TOC-->
<script>
  $(document).ready(function() {
    $('#TOC').parent().prepend('<div id=\"nav_logo\"><img src="Images/logo-programa.png"></div>');
  });
</script>
<style>
#nav_logo {
  width: 100%;
  margin-top: 20px;
}
</style>

<br>

<!--script for sharing-->
<p align="right">
```{r share, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', results = "asis"}
home <- "rehab-tech.github.io/observatoriocr/"
source("Scripts/social-media-sharing.R")
```
</p>

<br>

```{r fontes, echo = FALSE, warning = FALSE, message = FALSE, fig.align='center', results = "asis", out.width="85%"}
options(knitr.kable.NA = '--', knitr.table.format = "html")

# read separate sheets
file.path <- "../PPGCR Unisuam/Fontes.xlsx"
tabs <- excel_sheets(file.path)

# iterate across sheets
for (j in 1:length(tabs)) {
  cat('\n\n<!-- -->\n\n')
  cat("### **", tabs[j], "** {#", tolower(tabs[j]), "} \n", sep = "")
  cat('\n\n<!-- -->\n\n')
  fontes <-
    read_excel(file.path, sheet = tabs[j], col_types = c("text"))
  # replace the link by a tag
  for (i in 1:dim(fontes)[1]) {
    fontes[i, 1] <- paste("**", fontes[i, 1], "**", sep = "")
    fontes[i, 3] <-
      paste("[↗️](", fontes[i, 3], '){target="_blank"}', sep = "")
  }
  # print table
  print(
    kable(fontes, align = c("l", rep(
      "c", ncol(fontes) - 2
    ), "r")) %>% kable_styling(
      bootstrap_options = c("hover", "condensed", "responsive"),
      full_width = T,
      position = "center"
    )
  )
  cat('\n\n<!-- -->\n\n')
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
}
```
