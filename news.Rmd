---
title: News

output:
  html_document:
    toc: true
---

<!--install and/or load all R packages-->
```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE}
source("Scripts/all-required-packages.R")
```

<!--script for computer/mobile devices-->
```{css, echo=FALSE}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    body .main-container {
      max-width: 1280px !important;
      width: 80%;
      margin: auto;
      }
    body {
      max-width: 1280px !important;
      width: 80%;
      margin: auto;
    }
      section {
      position: absolute;
      top: 50%;
      left: 50%;
      margin-right: -50%;
      transform: translate(-50%, -50%)
    }
```

<!--script for narrow margins-->
<style type="text/css">
div.main-container {
  max-width: 1800px;
  margin-left: auto;
  margin-right: auto;
}
</style>

<!--script for inserting LOGO ABOVE THE TOC-->
<script>
  $(document).ready(function() {
    $('#TOC').parent().prepend('<div id=\"nav_logo\"><img src="Images/logo-programa.png"></div>');
  });
</script>
<style>
#nav_logo {
  width: 100%;
  margin-top: 20px;
}
</style>

<br>

<!--script for sharing-->
<p align="right">
```{r share, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', results = "asis"}
home <- "rehab-tech.github.io/observatoriocr/"
source("Scripts/social-media-sharing.R")
```
</p>

<br>

```{r news, echo = FALSE, warning = FALSE, message = FALSE, fig.align='center', results = "asis", out.width="80%"}
options(knitr.kable.NA = '--', knitr.table.format = "html")

# read packages






# read separate sheets
file.path <- "../PPGCR Unisuam/News.xlsx"
tabs <- excel_sheets(file.path)
topics <- c()
news.list <- vector(mode = "list", length = length(tabs))

# iterate across sheets
for(j in 1:length(tabs)){
  news <- read_excel(file.path, sheet = tabs[j], col_types = c("text", "text", "text"))
  # replace the link by a tag
  for(i in 1:dim(news)[1]){
    news[i,1] <- paste("## **", as.character(as.Date(as.numeric(news[i,1]), origin = "1899-12-30")), "**", sep = "")
    news[i,3] <- paste("[↗️](", news[i,3], '){target="_blank"}', sep = "")
  }
  
  # drop date column
  news <- news[, -1]
  # store data to print table
  news.list[[j]] <- news
  
  # store data to plot wordcloud
  topics <- rbind(topics, news[i,1])
}

# iterate across sheets
for(j in 1:length(tabs)){
  cat('\n\n<!-- -->\n\n')
  cat("### **", tabs[j], "**", "\n", sep = "")
  cat('\n\n<!-- -->\n\n')
  cat('<hr style="height:2px;border-width:0;color:#2C3E50;background-color:#2C3E50">')
  print(kable(news.list[[j]], align = c("l", rep("c", ncol(news)-2), "r")) %>% kable_styling(bootstrap_options = c("hover", "condensed", "responsive"), full_width = T, position = "center"))
  cat('\n\n<!-- -->\n\n')
  cat('<br><a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a><br>')
}

```

<hr style="height:2px;border-width:0;color:white;background-color:white">
