---
title: Sobre
output:
  html_document:
    toc: true
    css:
      - /CSS/logo-above-toc.css
      - /CSS/narrow-margins.css
      - /CSS/responsive.css
---

<!--install and/or load all R packages-->
```{r setup, include = FALSE, echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', out.width = "100%", results = "hide"}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.align = 'center',
  results = "asis",
  include = TRUE,
  out.width = "100%",
  knitr.kable.NA = '--',
  knitr.table.format = "html"
)
source("Scripts/all-required-packages.R")
```

<!--script for inserting LOGO ABOVE THE TOC-->
```{js}
$(document).ready(function() {
  $('#TOC').parent().prepend('<div id=\"nav_logo\"><img src="Images/logo-programa.png"></div>');
  });
```

<!--script for sharing-->
<p align="right">
```{r share}
home <- "https://ppgcr-unisuam.github.io/observatoriocr/"
source("Scripts/social-media-sharing.R")
```
</p>

<br>

## **Dados** {#dados}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:#2C3E50;background-color:#2C3E50">

<!--script for generating STACKED HORIZONTAL BAR CHART-->

```{css}
.row {
  display: flex;
  align-items: stretch;
  margin: 0 0;
}

.row .label {
  flex: 0 0 auto;
}

.row .bar-container {
  flex: 1;
  display: flex;
  align-items: stretch;
  justify-content: flex-start;
}

.row .bar {
  display: flex;
  justify-content: center;
  align-items: center;
}

.val-a { background: #18BC9C }
.val-b { background: #F39C12 }
```

```{r barchart-data}
# get amount of data from Sucupira XLSX files
source("Scripts/get-sucupira-sheets-names.R",
       local = knitr::knit_global())
sheets <- sucupira.sheets

data.sucupira <- 0
for (i in 1:length(sheets)) {
  sheet <- sheets[i]
  source("Scripts/read-xlsx-sucupira.R", local = knitr::knit_global())
  data.sucupira <- sum(data.sucupira,!is.na(sucupira.raw))
}

# get amount of data from PPG XLSX files
source("Scripts/get-ppg-xlsx-data.R", local = knitr::knit_global())

data.ppg <- 0
for (i in 1:length(files.to.read)) {
  abas <- excel_sheets(files.to.read[i])
  for (j in 1:length(abas)) {
    sheet <- sheets[j]
    ppg.file <- read_excel(files.to.read[i], sheet = abas[j])
    data.ppg <- sum(data.ppg,!is.na(ppg.file))
  }
}

# total data
total <- data.sucupira + data.ppg

# print stacked horizontal bar chart
cat('<div class="row">')
cat('<div class="bar-container">')
cat(
  paste0(
    '<div class="bar val-a" style="color:white; font-weight:bold; flex-basis:',
    data.sucupira / total * 100,
    '%">Plataforma Sucupira</div>'
  )
)
cat(
  paste0(
    '<div class="bar val-b" style="color:white; font-weight:bold; flex-basis:',
    data.ppg / total * 100,
    '%">Endógenos</div>'
  )
)
cat('</div>')
cat('</div>')
```

<br>

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>

## **Informações da sessão** {#sessioninfo}

<!--script for generating HORIZONTAL LINE-->
<hr style="height:2px;border-width:0;color:#2C3E50;background-color:#2C3E50">

<br>

<div><center><img width="10%" height="10%" src="https://github.com/rstudio/hex-stickers/blob/master/thumbs/RStudio.png?raw=true"> Esta página foi desenvolvida em [**`r R.version$version.string`**](https://www.rstudio.com) usando [**R markdown**](https://rmarkdown.rstudio.com)
</center></div>

<br>

<br>

```{r session-info}
sessioninfo::session_info()%>%
  details::details(
    summary = 'Current session info',
    open = FALSE
  )
```

<br>

<a style="float:right" href="#top"><b>Início &nbsp;</b>⬆️</a>

<br>
